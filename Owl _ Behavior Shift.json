{"paragraphs":[{"text":"import com.owl.core._\nimport org.apache.spark.sql.Row\nimport java.sql.Timestamp\nimport java.text.SimpleDateFormat\nimport org.apache.spark.sql.types._\n\nval l = Seq(\n  Row(\"Kirk\", new Timestamp(new SimpleDateFormat(\"yyyy-MM-dd\").parse(\"2018-02-24\").getTime), 18),\n  Row(\"Mark\", new Timestamp(new SimpleDateFormat(\"yyyy-MM-dd\").parse(\"2018-02-24\").getTime), 19),\n  Row(\"1.0\",  new Timestamp(new SimpleDateFormat(\"yyyy-MM-dd\").parse(\"2018-02-24\").getTime), 19),\n\n  Row(\"Jake\", new Timestamp(new SimpleDateFormat(\"yyyy-MM-dd\").parse(\"2018-02-23\").getTime), 11),\n\n  Row(\"Kirk\", new Timestamp(new SimpleDateFormat(\"yyyy-MM-dd\").parse(\"2018-02-22\").getTime), null),\n  Row(\"Rob\",  new Timestamp(new SimpleDateFormat(\"yyyy-MM-dd\").parse(\"2018-02-22\").getTime), null),\n\n  Row(null,   new Timestamp(new SimpleDateFormat(\"yyyy-MM-dd\").parse(\"2018-02-21\").getTime), 12),\n  Row(\"Jake\", new Timestamp(new SimpleDateFormat(\"yyyy-MM-dd\").parse(\"2018-02-21\").getTime), 11),\n\n  Row(\"Kirk\", new Timestamp(new SimpleDateFormat(\"yyyy-MM-dd\").parse(\"2018-02-20\").getTime), 10),\n  Row(\"John\", new Timestamp(new SimpleDateFormat(\"yyyy-MM-dd\").parse(\"2018-02-20\").getTime), 10)\n)\n\nval schema = StructType(\n  List(\n    StructField(\"fname\", StringType, true),\n    StructField(\"app_date\", TimestampType, true),\n    StructField(\"price\", IntegerType, true)\n  )\n)\nval df = spark.createDataFrame(spark.sparkContext.parallelize(l), schema)\n\nval owl = new Owl(df)\nval profile1 = owl.profileDF()\nval profile = owl.profileDF(runId = \"2018-02-24\", lookback = 5, dateCol = \"app_date\", tbin = \"DAY\")\nprofile.createOrReplaceTempView(\"profile\")\nprofile1.createOrReplaceTempView(\"profile1\")\nval shift = owl.shiftDF(profile, df.where(\"app_date ='2018-02-24'\"))\nshift.createOrReplaceTempView(\"shift\")","user":"anonymous","dateUpdated":"2018-07-02T17:56:14-0400","config":{"colWidth":6,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala","tableHide":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import com.owl.core._\nimport org.apache.spark.sql.Row\nimport java.sql.Timestamp\nimport java.text.SimpleDateFormat\nimport org.apache.spark.sql.types._\nl: Seq[org.apache.spark.sql.Row] = List([Kirk,2018-02-24 00:00:00.0,18], [Mark,2018-02-24 00:00:00.0,19], [1.0,2018-02-24 00:00:00.0,19], [Jake,2018-02-23 00:00:00.0,11], [Kirk,2018-02-22 00:00:00.0,null], [Rob,2018-02-22 00:00:00.0,null], [null,2018-02-21 00:00:00.0,12], [Jake,2018-02-21 00:00:00.0,11], [Kirk,2018-02-20 00:00:00.0,10], [John,2018-02-20 00:00:00.0,10])\nschema: org.apache.spark.sql.types.StructType = StructType(StructField(fname,StringType,true), StructField(app_date,TimestampType,true), StructField(price,IntegerType,true))\ndf: org.apache.spark.sql.DataFrame = [fname: string, app_date: timestamp ... 1 more field]\nowl: com.owl.core.Owl = com.owl.core.Owl@a5bd8a5\nroot\n |-- fname: string (nullable = true)\n |-- app_date: timestamp (nullable = true)\n |-- price: integer (nullable = true)\n\n+-----+--------------------+-----+------+\n|fname|            app_date|price|owl_id|\n+-----+--------------------+-----+------+\n| Kirk|2018-02-24 00:00:...|   18|     1|\n| Mark|2018-02-24 00:00:...|   19|     2|\n|  1.0|2018-02-24 00:00:...|   19|     3|\n| Jake|2018-02-23 00:00:...|   11|     4|\n| Kirk|2018-02-22 00:00:...| null|     5|\n|  Rob|2018-02-22 00:00:...| null|     6|\n| null|2018-02-21 00:00:...|   12|     7|\n| Jake|2018-02-21 00:00:...|   11|     8|\n| Kirk|2018-02-20 00:00:...|   10|     9|\n| John|2018-02-20 00:00:...|   10|    10|\n+-----+--------------------+-----+------+\n\nroot\n |-- fname: integer (nullable = true)\n |-- app_date: integer (nullable = true)\n |-- price: integer (nullable = true)\n |-- owl_id: long (nullable = true)\n\n(fname_STRING,8)\n(fname_SHAPE_x.x,1)\n(app_date_DATE,10)\n(rc,10)\n(fname_INT,1)\n(price_INT,8)\n(owl_id_LONG,10)\n(fname_NCNT,1)\n(price_NCNT,2)\n(fname_SHAPE_Int,1)\nprofile1: org.apache.spark.sql.DataFrame = [column: string, nulls: bigint ... 10 more fields]\nroot\n |-- fname: string (nullable = true)\n |-- app_date: timestamp (nullable = true)\n |-- price: integer (nullable = true)\n |-- time_bin: string (nullable = true)\n\n+-----+--------------------+-----+----------+------+\n|fname|            app_date|price|  time_bin|owl_id|\n+-----+--------------------+-----+----------+------+\n| Jake|2018-02-23 00:00:...|   11|2018-02-23|     1|\n+-----+--------------------+-----+----------+------+\n\nroot\n |-- fname: integer (nullable = true)\n |-- app_date: integer (nullable = true)\n |-- price: integer (nullable = true)\n |-- time_bin: integer (nullable = true)\n |-- owl_id: long (nullable = true)\n\n(fname_STRING,1)\n(time_bin_STRING,1)\n(app_date_DATE,1)\n(rc,1)\n(price_INT,1)\n(owl_id_LONG,1)\n(time_bin_SHAPE_xxxx-xx-xx,1)\nroot\n |-- fname: string (nullable = true)\n |-- app_date: timestamp (nullable = true)\n |-- price: integer (nullable = true)\n |-- time_bin: string (nullable = true)\n\n+-----+--------------------+-----+----------+------+\n|fname|            app_date|price|  time_bin|owl_id|\n+-----+--------------------+-----+----------+------+\n| Kirk|2018-02-22 00:00:...| null|2018-02-22|     1|\n|  Rob|2018-02-22 00:00:...| null|2018-02-22|     2|\n+-----+--------------------+-----+----------+------+\n\nroot\n |-- fname: integer (nullable = true)\n |-- app_date: integer (nullable = true)\n |-- price: integer (nullable = true)\n |-- time_bin: integer (nullable = true)\n |-- owl_id: long (nullable = true)\n\n(fname_STRING,2)\n(time_bin_STRING,2)\n(app_date_DATE,2)\n(rc,2)\n(owl_id_LONG,2)\n(price_NCNT,2)\n(time_bin_SHAPE_xxxx-xx-xx,2)\nroot\n |-- fname: string (nullable = true)\n |-- app_date: timestamp (nullable = true)\n |-- price: integer (nullable = true)\n |-- time_bin: string (nullable = true)\n\n+-----+--------------------+-----+----------+------+\n|fname|            app_date|price|  time_bin|owl_id|\n+-----+--------------------+-----+----------+------+\n| null|2018-02-21 00:00:...|   12|2018-02-21|     1|\n| Jake|2018-02-21 00:00:...|   11|2018-02-21|     2|\n+-----+--------------------+-----+----------+------+\n\nroot\n |-- fname: integer (nullable = true)\n |-- app_date: integer (nullable = true)\n |-- price: integer (nullable = true)\n |-- time_bin: integer (nullable = true)\n |-- owl_id: long (nullable = true)\n\n(fname_STRING,1)\n(time_bin_STRING,2)\n(app_date_DATE,2)\n(rc,2)\n(price_INT,2)\n(owl_id_LONG,2)\n(fname_NCNT,1)\n(time_bin_SHAPE_xxxx-xx-xx,2)\nroot\n |-- fname: string (nullable = true)\n |-- app_date: timestamp (nullable = true)\n |-- price: integer (nullable = true)\n |-- time_bin: string (nullable = true)\n\n+-----+--------------------+-----+----------+------+\n|fname|            app_date|price|  time_bin|owl_id|\n+-----+--------------------+-----+----------+------+\n| Kirk|2018-02-20 00:00:...|   10|2018-02-20|     1|\n| John|2018-02-20 00:00:...|   10|2018-02-20|     2|\n+-----+--------------------+-----+----------+------+\n\nroot\n |-- fname: integer (nullable = true)\n |-- app_date: integer (nullable = true)\n |-- price: integer (nullable = true)\n |-- time_bin: integer (nullable = true)\n |-- owl_id: long (nullable = true)\n\n(fname_STRING,2)\n(time_bin_STRING,2)\n(app_date_DATE,2)\n(rc,2)\n(price_INT,2)\n(owl_id_LONG,2)\n(time_bin_SHAPE_xxxx-xx-xx,2)\nroot\n |-- fname: string (nullable = true)\n |-- app_date: timestamp (nullable = true)\n |-- price: integer (nullable = true)\n |-- time_bin: string (nullable = true)\n\n+-----+--------+-----+--------+------+\n|fname|app_date|price|time_bin|owl_id|\n+-----+--------+-----+--------+------+\n+-----+--------+-----+--------+------+\n\nroot\n |-- fname: integer (nullable = true)\n |-- app_date: integer (nullable = true)\n |-- price: integer (nullable = true)\n |-- time_bin: integer (nullable = true)\n |-- owl_id: long (nullable = true)\n\nprofile: org.apache.spark.sql.DataFrame = [column: string, avg_nulls: double ... 7 more fields]\nroot\n |-- fname: string (nullable = true)\n |-- app_date: timestamp (nullable = true)\n |-- price: integer (nullable = true)\n\n+-----+--------------------+-----+------+\n|fname|            app_date|price|owl_id|\n+-----+--------------------+-----+------+\n| Kirk|2018-02-24 00:00:...|   18|     1|\n| Mark|2018-02-24 00:00:...|   19|     2|\n|  1.0|2018-02-24 00:00:...|   19|     3|\n+-----+--------------------+-----+------+\n\nroot\n |-- fname: integer (nullable = true)\n |-- app_date: integer (nullable = true)\n |-- price: integer (nullable = true)\n |-- owl_id: long (nullable = true)\n\n(fname_STRING,2)\n(fname_SHAPE_x.x,1)\n(app_date_DATE,3)\n(rc,3)\n(fname_INT,1)\n(price_INT,3)\n(owl_id_LONG,3)\n(fname_SHAPE_Int,1)\nshift: org.apache.spark.sql.DataFrame = [column: string, perchange_nulls: double ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1529680004756_637903337","id":"20180622-110644_733672500","dateCreated":"2018-06-22T11:06:44-0400","dateStarted":"2018-07-02T17:55:36-0400","dateFinished":"2018-07-02T17:55:42-0400","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6481"},{"title":"Standard Deviation Scale","text":"%sql\nselect * from shift","user":"anonymous","dateUpdated":"2018-07-02T17:57:05-0400","config":{"colWidth":6,"enabled":true,"results":{"0":{"graph":{"mode":"multiBarChart","height":492,"optionOpen":false,"setting":{"scatterChart":{"xAxis":{"name":"column","index":0,"aggr":"sum"},"yAxis":{"name":"zscore_cardinality","index":4,"aggr":"sum"}},"multiBarChart":{"stacked":true}},"commonSetting":{},"keys":[{"name":"column","index":0,"aggr":"sum"}],"groups":[],"values":[{"name":"zscore_nulls","index":2,"aggr":"sum"},{"name":"zscore_empties","index":3,"aggr":"sum"},{"name":"zscore_cardinality","index":4,"aggr":"sum"},{"name":"zscore_mixed","index":5,"aggr":"sum"}]},"helium":{}}},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql","title":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"column\tperchange_nulls\tzscore_nulls\tzscore_empties\tzscore_cardinality\tzscore_mixed\tshifted\nowl_id\tnull\tnull\tnull\t1.788854381999832\tnull\tfalse\nfname\t100.0\t-0.447213595499958\tnull\t2.1514114968019085\tnull\ttrue\nprice\t100.0\t-0.447213595499958\tnull\t1.4342743312012722\tnull\tfalse\napp_date\tnull\tnull\tnull\t0.44721359549995787\tnull\tfalse\n"}]},"apps":[],"jobName":"paragraph_1529680037979_1109467570","id":"20180622-110717_1147723584","dateCreated":"2018-06-22T11:07:17-0400","dateStarted":"2018-07-02T17:54:18-0400","dateFinished":"2018-07-02T17:54:23-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6482"},{"text":"%sql\nselect * from profile","user":"anonymous","dateUpdated":"2018-07-02T17:54:17-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"column\tavg_nulls\tdev_nulls\tavg_empties\tdev_empties\tavg_cardinality\tdev_cardinality\tavg_mixed\tdev_mixed\nowl_id\t0.0\t0.0\t0.0\t0.0\t1.4\t0.8944271909999159\t0.0\t0.0\nfname\t0.2\t0.4472135954999579\t0.0\t0.0\t1.2\t0.8366600265340756\t0.0\t0.0\nprice\t0.4\t0.8944271909999159\t0.0\t0.0\t0.8\t0.8366600265340756\t0.0\t0.0\napp_date\t0.0\t0.0\t0.0\t0.0\t0.8\t0.4472135954999579\t0.0\t0.0\ntime_bin\t0.0\t0.0\t0.0\t0.0\t0.8\t0.4472135954999579\t0.0\t0.0\n"}]},"apps":[],"jobName":"paragraph_1529680253826_-1659110538","id":"20180622-111053_742915338","dateCreated":"2018-06-22T11:10:53-0400","dateStarted":"2018-07-02T17:54:23-0400","dateFinished":"2018-07-02T17:54:24-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6483"},{"text":"%sql\nselect * from profile1","user":"anonymous","dateUpdated":"2018-07-02T17:55:46-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"column\tnulls\tempties\tcardinality\tis_mixed\tmixed_ratio\tLong\tString\tBoolean\tDouble\tDate\tInt\nfname\t1\t0\t6\ttrue\t0.1\t0\t8\t0\t0\t0\t1\nprice\t2\t0\t5\tfalse\t0.0\t0\t0\t0\t0\t0\t8\napp_date\t0\t0\t5\tfalse\t0.0\t0\t0\t0\t0\t10\t0\nowl_id\t0\t0\t10\tfalse\t0.0\t10\t0\t0\t0\t0\t0\n"}]},"apps":[],"jobName":"paragraph_1529680290930_2104964572","id":"20180622-111130_1553581066","dateCreated":"2018-06-22T11:11:30-0400","dateStarted":"2018-07-02T17:55:46-0400","dateFinished":"2018-07-02T17:55:46-0400","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:6484"},{"text":"%sql\n","user":"anonymous","dateUpdated":"2018-07-02T17:55:46-0400","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sql"},"editorMode":"ace/mode/sql"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1530568546573_-1581011760","id":"20180702-175546_384581237","dateCreated":"2018-07-02T17:55:46-0400","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:6485"}],"name":"Owl / Behavior Shift","id":"2DGVPUH4X","angularObjects":{"2DFW5AMX7:shared_process":[],"2DG2GK25N:shared_process":[],"2DGRFFZMA:shared_process":[],"2DERM7RYU:shared_process":[],"2DFFH5QGT:shared_process":[],"2DF2PH329:shared_process":[],"2DF55VSFN:shared_process":[],"2DH2XWUQA:shared_process":[],"2DGHUQGA8:shared_process":[],"2DH9U1ABT:shared_process":[],"2DDPWP28H:shared_process":[],"2DEK5Z276:shared_process":[],"2DDTZ2MKK:shared_process":[],"2DGZQPS75:shared_process":[],"2DF6DQ2V6:shared_process":[],"2DDPQKAK4:shared_process":[],"2DDTQYJ7P:shared_process":[],"2DGCHXAN1:shared_process":[],"2DFDNF2GQ:shared_process":[],"2DHD7TD9C:shared_process":[]},"config":{"looknfeel":"default","personalizedMode":"false"},"info":{}}